# What is the `my-netdata` menu?

It lists the netdata servers you have visited.


## Why?

netdata provides distributed monitoring.

Traditional monitoring solutions centralize all the data to provide unified dashboards across all servers. Before netdata, this was the standard practice. However it has a few cons:

1. due to the resources required, the number of metrics collected is limited.
2. for the same reason, the data collection frequency is not that high, at best it will be once every 10 or 15 seconds, at worst every 5 or 10 mins.
2. the central monitoring solution can only *scale up*, thus becoming "another bottleneck" in the whole ecosystem. It also requires maintenance, administration, etc.
3. due to all the above, most centralized monitoring solutions are usually only good for presenting *statistics of past performance* (i.e. cannot be used for performance troubleshooting).

Netdata has a different approach:

1. data collection happens per second
2. thousands of metrics per server are collected
3. data do not leave the server they are collected
4. netdata servers do not talk to each other
5. your browser connects all the netdata servers

Using netdata, your monitoring infrastructure is embedded on each server, limiting significantly the need of central resources. netdata is very resource efficient and utilizes server resources that already exist and are spare (on each server). This allows **scaling out** the monitoring infrastructure. 

However, the netdata approach introduces a few new issues that need to be addressed, one being **the list of netdata we have installed**, i.e. the URLs our netdata servers are listening.

To solve this, netdata utilizes a **central registry**.

## What is the registry?

The registry keeps track of 3 entities:

1. **machines**: i.e. the netdata installations (a random GUID generated by each netdata the first time it starts; we call this **machine_guid**)

  For each netdata installation (each `machine_guid`) the registry keeps track of the different URLs it is accessed.

2. **persons**: i.e. the web browsers accessing the netdata installations (a random GUID generated by the registry the first time it sees a new web browser; we call this **person_guid**)

  For each person, the registry keeps track of the netdata installations it has accessed and their URLs.

3. **URLs** of netdata installations (as seen by the web browsers)

  For each URL, the registry keeps the URL and nothing more. Each URL is just linked to *persons* and *machines*. The only way to find a URL is to know its **machine_guid** or have a **person_guid** it is linked to it.

## Who talks to the registry?

Your web browser **only**!

Your netdata servers do not talk to the registry. This is a UML diagram of its operation:

![image](https://cloud.githubusercontent.com/assets/2662304/15268669/2990d818-19ef-11e6-831f-4328c8484424.png)

```sequence
web browser->netdata1: give me the dashboard
netdata1-->web browser: here it is
web browser->netdata1: give me registry info
netdata1-->web browser:  here it is, talk to registry1
web browser->registry1: Hey registry1, I am accessing netdata1
registry1-->web browser: nice!, here are other netdata servers you have accessed in the past
```


## What data the registry maintains?

Its database contains:

- **random person GUIDs** (generated by the registry as a browser cookie)
- **random machine GUIDs** (generated by each netdata server on its first run)
- **URLs** (the base URL for accessing a netdata server, as seen by the web browser)

For *persons* and *machines*, the registry keeps links to *URLs*, each link with 2 timestamps (first time seen, last time seen) and a counter (number of times it has been seen).

## Which is the default registry?

`https://registry.my-netdata.io`, which is currently served by `https://london.my-netdata.io`. This registry listens to both HTTP and HTTPS requests but the default is HTTPS.

#### Can this registry handle the global load of netdata installations?

Yeap! The registry can handle 50.000 - 100.000 requests **per second per core** (depending on the type of CPU, the computer's memory bandwidth, etc). 50.000 is on J1900 (celeron 2Ghz).

We believe, it can do it...

## Every netdata can be a registry

Yes, you read correct, **every netdata can be a registry**. Just pick one and configure it.

To turn any netdata into a registry just edit `/etc/netdata/netdata.conf` and set:

```
[registry]
    enabled = yes
    registry to announce = http://your.registry:19999
```

Restart your netdata to activate it.

Then, you need to tell all your other netdata servers to advertise your registry, instead of the default. To do this, on each of your netdata servers, edit `/etc/netdata/netdata.conf` and set:

```
[registry]
    enabled = no
    registry to announce = http://your.registry:19999
```

Note that we have not enabled the registry on the other servers. Only one netdata (the registry) needs `[registry].enabled = yes`.

This is it. You have your registry now.

You may also want to give your server different names under the **my-netdata** menu (i.e. to have them sorted / grouped). You can change its registry name, by setting on each netdata server:

```
[registry]
    registry hostname = Group1 - Master DB
```

So this server will appear in **my-netdata** as `Group1 - Master DB`. The max name length is 50 characters.

#### Where is the registry database stored?

`/var/lib/netdata/registry/*.db`

There can be up to 2 files:

- `registry-log.db`, the transaction log

    all incoming requests that affect the registry are saved in this file in real-time.

- `registry.db`, the database

    every `[registry].registry save db every new entries` entries in `registry-log.db`, netdata will save its database to `registry.db` and empty `registry-log.db`.

Both files are machine readable text files.
